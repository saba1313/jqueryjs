<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Shopping cart demo - Draggables, droppable, FX Highlight, Fx Drop, FX Pulsate</title>
<script type="text/javascript" src="../jquery/jquery/jquery.js"></script>
<script type="text/javascript" src="../jquery/selector/selector.js"></script>
<script type="text/javascript" src="../jquery/ajax/ajax.js"></script>
<script type="text/javascript" src="../jquery/event/event.js"></script>
<script type="text/javascript" src="../jquery/fx/fx.js"></script>
<script type="text/javascript" src="../interface/iutil.js"></script>
<script type="text/javascript" src="../interface/idrag.js"></script>
<script type="text/javascript" src="../interface/idrop.js"></script>
<script type="text/javascript" src="../interface/ifx.js"></script>
<script type="text/javascript" src="../interface/ifxhighlight.js"></script>
<script type="text/javascript" src="../interface/ifxdrop.js"></script>
<script type="text/javascript" src="../interface/ifxpulsate.js"></script>
<style type="text/css">
*
{
	margin: 0;
	padding: 0;
}
body
{
	background-color: #fff;
	color: #000;
	font-family:Arial, Helvetica, sans-serif;
	padding: 20px;
	font-size: 12px;
}
h1
{
	font-size: 15px;
	color: #6CAF00;
	margin: 0 0 30px 0;
}
#cart
{
	width: 200px;
	border: 1px solid #eee;
	float: right;
}
#cart h3
{
	background-color: #6CAF00;
	padding: 4px;
	color: #000;
	font-size: 12px;
	color: #fff;
}
#cart p
{
	padding:  10px 4px;
}
.cart
{
	background-color: #f8f8f8;
}
.activeCart
{
	background-color: #DAFF9F;
}
.hoverCart
{
	background-color:#FFFFCC;
}
#products
{
	margin-right: 250px;
}
.product
{
	width: 200px;
	height: 200px;
	float: left;
	margin-bottom: 20px;
}
.product h2
{
	font-size: 12px;
	padding: 6px 0;
}
.product p
{
	font-size: 11px;
	color: #333;
}
.productCart
{
	font-size: 10px;
	margin: 10px;
}
.productCart a
{
	color: #f00;
	float: right;
}
</style>
</head>

<body>
<div id="cart" class="cart">
	<h3>Your cart</h3>
	<div id="cartProducts"></div>
	<p><strong>Total: <span id="cartTotal">0.-</span> $</strong></p>
</div>
<h1>Drag products into shopping cart</h1>
<div id="products">
	<div id="product1" class="product">
		<img src="images/cart/th_17l519col3.jpg" alt="" />
		<h2>Product 1</h2>
		<p>Long sleeve shirt</p>
		<p><strong>Price: <span>49.95</span> $</strong></p>
	</div>
	<div id="product2" class="product">
		<img src="images/cart/th_30l519col4.jpg" width="170" height="128" />
		<h2>Product 2</h2>
		<p>Long Sleeve, stripes</p>
		<p><strong>Price: <span>49.95</span> $</strong></p>
	</div>
	<div id="product3" class="product">
		<img src="images/cart/th_13l569col2.jpg" width="170" height="128" />
		<h2>Product 3</h2>
		<p>Long Sleeve fantasy style</p>
		<p><strong>Price: <span>49.95</span> $</strong></p>
	</div>
	<div id="product4" class="product">
		<img src="images/cart/th_13l569col1.jpg" width="170" height="128" />
		<h2>Product 4</h2>
		<p>Long sleeve classic style white fantasy</p>
		<p><strong>Price: <span>49.95</span> $</strong></p>
	</div>
	<div id="product5" class="product">
		<img src="images/cart/th_17l519col1.jpg" width="170" height="128" />
		<h2>Product 5</h2>
		<p>Long sleeve, stripes</p>
		<p><strong>Price: <span>49.95</span> $</strong></p>
	</div>
	<div id="product6" class="product">
		<img src="images/cart/th_519plain1112col3.jpg" width="170" height="128" />
		<h2>Product 6</h2>
		<p>Long sleeve</p>
		<p><strong>Price: <span>49.95</span> $</strong></p>
	</div>
</div>
<script type="text/javascript">
$(document).ready(
	function()
	{
		$('div.product').Draggable({revert: true, fx: 300, ghosting: true, opacity: 0.4});
		$('#cart').Droppable(
			{
				accept :		'product', 
				activeclass:	'activeCart', 
				hoverclass:		'hoverCart',
				tolerance:		'intersect',
				onDrop:			function(dragged)
				{
					var productName = $('h2', dragged).html();
					var productPrice = parseFloat($('span', dragged).html());
					var productId = $(dragged).attr('id');
					var isInCart = $('#' + productId + '_cart');
					if (isInCart.size() == 1) {
						var quantity = parseInt(isInCart.find('span.quantity').html()) + 1;
						isInCart.find('span.quantity').html(quantity+'').end().Pulsate(300, 2);
					} else {
						$('#cartProducts')
							.append('<div class="productCart" id="' + productId + '_cart">' + productName + '<a href="#">remove</a><br />qty: <span class="quantity">1</span><br />price: <span class="price">' + productPrice + ' $</span></div>')
							.find('div.productCart:last')
							.fadeIn(400)
							.find('a')
							.bind(
								'click', 
								function(){
									$(this.parentNode).DropOutDown(
										400,
										function() {
											$(this).remove();
											calculateCartTotal();
										}
									);
									return false;
								}
							);
					}
					calculateCartTotal();
				}
			}
		);
	}
);

var calculateCartTotal = function()
{
	var total = 0;
	$('#cartProducts .productCart').each(
		function()
		{
			var price = parseFloat($('span.price', this).html());
			var quantity = parseInt($('span.quantity', this).html());
			total += price * quantity;
		}
	);
	$('#cartTotal').html(formatNr(total));
	$('#cart p').Highlight(500, '#ff0');
};
var formatNr = function(nr)
{
	thousands = parseInt(nr/1000);
	hundreds = parseInt(nr - thousands*1000);
	decimals = parseInt((nr - parseInt(nr)) * 100);
	return (thousands > 0 ? thousands + ' ' : '') + (nr > 1000 & hundreds < 100 ? '0' : '') + (nr > 1000 & hundreds < 10 ? '0' : '') + hundreds + '.' + (decimals > 0 ? decimals : '-');
}
</script>
</body>
</html>
