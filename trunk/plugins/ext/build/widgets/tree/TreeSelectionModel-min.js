/*
 * Ext - JS Library 1.0 Alpha 2
 * Copyright(c) 2006-2007, Jack Slocum.
 * 
 * http://www.extjs.com/license.txt
 */

Ext.tree.DefaultSelectionModel=function(){this.selNode=null;this.events={"selectionchange":true};};Ext.extend(Ext.tree.DefaultSelectionModel,Ext.util.Observable,{init:function(_1){this.tree=_1;_1.el.on("keydown",this.onKeyDown,this);_1.on("click",this.onNodeClick,this);},onNodeClick:function(_2,e){this.select(_2);},select:function(_4){if(this.selNode&&this.selNode!=_4){this.selNode.ui.onSelectedChange(false);}this.selNode=_4;_4.ui.onSelectedChange(true);this.fireEvent("selectionchange",this,_4);return _4;},unselect:function(_5){if(this.selNode==_5){this.clearSelections();}},clearSelections:function(){var n=this.selNode;if(n){n.ui.onSelectedChange(false);this.selNode=null;this.fireEvent("selectionchange",this,null);}return n;},getSelectedNode:function(){return this.selNode;},isSelected:function(_7){return this.selNode==_7;},onKeyDown:function(e){var s=this.selNode||this.lastSelNode;var sm=this;if(!s){return;}var k=e.getKey();switch(k){case e.DOWN:e.preventDefault();if(s.firstChild&&s.isExpanded()){this.select(s.firstChild,e);}else{if(s.nextSibling){this.select(s.nextSibling,e);}else{if(s.parentNode){s.parentNode.bubble(function(){if(this.nextSibling){sm.select(this.nextSibling,e);return false;}});}}}break;case e.UP:e.preventDefault();var ps=s.previousSibling;if(ps){if(!ps.isExpanded()){this.select(ps,e);}else{var lc=ps.lastChild;while(lc&&lc.isExpanded()){lc=lc.lastChild;}this.select(lc,e);}}else{if(s.parentNode&&(this.tree.rootVisible||!s.parentNode.isRoot)){this.select(s.parentNode,e);}}break;case e.RIGHT:e.preventDefault();if(s.hasChildNodes()){if(!s.isExpanded()){s.expand();}else{if(s.firstChild){this.select(s.firstChild,e);}}}break;case e.LEFT:e.preventDefault();if(s.hasChildNodes()&&s.isExpanded()){s.collapse();}else{if(s.parentNode&&(this.tree.rootVisible||s.parentNode!=this.tree.getRootNode())){this.select(s.parentNode,e);}}break;}}});Ext.tree.MultiSelectionModel=function(){this.selNodes=[];this.selMap={};this.events={"selectionchange":true};};Ext.extend(Ext.tree.MultiSelectionModel,Ext.util.Observable,{init:function(_e){this.tree=_e;_e.el.on("keydown",this.onKeyDown,this);_e.on("click",this.onNodeClick,this);},onNodeClick:function(_f,e){this.select(_f,e,e.ctrlKey);},select:function(_11,e,_13){if(_13!==true){this.clearSelections(true);}this.selNodes.push(_11);this.selMap[_11.id]=_11;this.lastSelNode=_11;_11.ui.onSelectedChange(true);this.fireEvent("selectionchange",this,this.selNodes);return _11;},unselect:function(_14){if(this.selMap[_14.id]){_14.ui.onSelectedChange(false);var sn=this.selNodes;var _16=-1;if(sn.indexOf){_16=sn.indexOf(_14);}else{for(var i=0,len=sn.length;i<len;i++){if(sn[i]==_14){_16=i;break;}}}if(_16!=-1){this.selNodes.splice(_16,1);}delete this.selMap[_14.id];this.fireEvent("selectionchange",this,this.selNodes);}},clearSelections:function(_19){var sn=this.selNodes;if(sn.length>0){for(var i=0,len=sn.length;i<len;i++){sn[i].ui.onSelectedChange(false);}this.selNodes=[];this.selMap={};if(_19!==true){this.fireEvent("selectionchange",this,this.selNodes);}}},isSelected:function(_1d){return this.selMap[_1d.id]?true:false;},getSelectedNodes:function(){return this.selNodes;},onKeyDown:Ext.tree.DefaultSelectionModel.prototype.onKeyDown});
