<html><head><title>Editor.js</title><link rel="stylesheet" type="text/css" href="../resources/style.css" media="screen"/></head><body><h1>Editor.js</h1><pre class="highlighted"><code>Ext.Editor = <b>function</b>(field, config){
    Ext.Editor.superclass.constructor.call(<b>this</b>, config);
    <b>this</b>.field = field;
    <b>this</b>.addEvents({
        'beforestartedit' : true,
        'startedit' : true,
        'beforecomplete' : true,
        'complete' : true,
        'specialkey' : true
    });
};

Ext.extend(Ext.Editor, Ext.Component, {
    value : '',
    alignment: 'c-c?',
    shadow : 'frame',
    onRender : <b>function</b>(ct){
        <b>this</b>.el = <b>new</b> Ext.Layer({
            shadow: <b>this</b>.shadow,
            cls: 'xeditor',
            parentEl : ct,
            shim : <b>this</b>.shim,
            shadowOffset:3
        });
        <b>this</b>.el.setStyle('overflow', Ext.isGecko ? 'auto' : 'hidden');
        <b>this</b>.field.render(<b>this</b>.el);
        <b>this</b>.field.show();
        <b>this</b>.field.on('blur', <b>this</b>.onBlur, <b>this</b>);
        <b>this</b>.relayEvents(<b>this</b>.field,  ['specialkey']);
        <b>if</b>(this.field.grow){
            <b>this</b>.field.on('autosize', <b>this</b>.el.sync,  <b>this</b>.el, {delay:1});
        }
    },

    startEdit : <b>function</b>(el, value){
        <b>if</b>(this.editing){
            <b>this</b>.completeEdit();
        }
        <b>this</b>.boundEl = Ext.get(el);
        <b>var</b> v = value !== undefined ? value : <b>this</b>.boundEl.dom.innerHTML;
        <b>if</b>(this.fireEvent('beforestartedit', <b>this</b>, <b>this</b>.boundEl, v) === false){
            <b>return</b>;
        }
        <b>if</b>(!<b>this</b>.rendered){
            <b>this</b>.render(<b>this</b>.parentEl || document.body);
        }
        <b>this</b>.startValue = v;
        <b>this</b>.field.setValue(v);
        <b>if</b>(this.autoSize){
            <b>var</b> sz = <b>this</b>.boundEl.getSize();
            <b>switch</b>(this.autoSize){
                <b>case</b> 'width':
                <b>this</b>.field.setSize(sz.width,  '');
                <b>break</b>;
                <b>case</b> 'height':
                <b>this</b>.field.setSize('',  sz.height);
                <b>break</b>;
                <b>default</b>:
                <b>this</b>.field.setSize(sz.width,  sz.height);
            }
        }
        <b>this</b>.el.alignTo(<b>this</b>.boundEl, <b>this</b>.alignment);
        <b>this</b>.editing = true;
        <b>if</b>(Ext.QuickTips){
            Ext.QuickTips.disable();
        }
        <b>this</b>.show();
    },

    realign : <b>function</b>(){
        <b>this</b>.el.alignTo(<b>this</b>.boundEl, <b>this</b>.alignment);
    },

    completeEdit : <b>function</b>(remainVisible){
        <b>var</b> v = <b>this</b>.getValue();
        <b>if</b>(this.revertInvalid !== false &amp;&amp; !<b>this</b>.field.isValid()){
            v = <b>this</b>.startValue;
            <b>this</b>.cancelEdit(true);
        }
        <b>if</b>(v == <b>this</b>.startValue &amp;&amp; <b>this</b>.ignoreNoChange){
            <b>this</b>.editing = false;
            <b>this</b>.hide();
        }
        <b>if</b>(this.fireEvent('beforecomplete', <b>this</b>, v, <b>this</b>.startValue) !== false){
            <b>this</b>.editing = false;
            <b>if</b>(this.updateEl &amp;&amp; <b>this</b>.boundEl){
                <b>this</b>.boundEl.update(v);
            }
            <b>if</b>(remainVisible !== true){
                <b>this</b>.hide();
            }
            <b>this</b>.fireEvent('complete', <b>this</b>, v, <b>this</b>.startValue);
        }
    },

    onShow : <b>function</b>(){
        <b>this</b>.el.show();
        <b>if</b>(this.hideEl !== false){
            <b>this</b>.boundEl.hide();
        }
        <b>this</b>.field.show();
        <b>this</b>.field.focus();
        <b>this</b>.fireEvent('startedit', <b>this</b>.boundEl, <b>this</b>.startValue);
    },

    cancelEdit : <b>function</b>(remainVisible){
        <b>this</b>.setValue(<b>this</b>.startValue);
        <b>if</b>(remainVisible !== true){
            <b>this</b>.hide();
        }
    },

    onBlur : <b>function</b>(){
        <b>if</b>(this.allowBlur !== true &amp;&amp; <b>this</b>.editing){
            <b>this</b>.completeEdit();
        }
    },

    onHide : <b>function</b>(){
        <b>if</b>(this.editing){
            <b>this</b>.completeEdit();
            <b>return</b>;
        }
        <b>this</b>.field.blur();
        <b>this</b>.el.hide();
        <b>if</b>(this.hideEl !== false){
            <b>this</b>.boundEl.show();
        }
        <b>if</b>(Ext.QuickTips){
            Ext.QuickTips.enable();
        }
    },

    setValue : <b>function</b>(v){
        <b>this</b>.field.setValue(v);
    },

    getValue : <b>function</b>(){
        <b>return</b> this.field.getValue();
    }
});</code></pre><hr><div style="font-size:10px;text-align:center;color:gray;">yui-ext - Copyright &copy; 2006 Jack Slocum.  |
    Yahoo! UI - Copyright &copy; 2006 Yahoo! Inc.<br />All rights reserved.</div>
    </body></html>