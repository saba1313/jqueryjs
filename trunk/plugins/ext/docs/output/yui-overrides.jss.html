<html><head><title>yui-overrides.js</title><link rel="stylesheet" type="text/css" href="../resources/style.css" media="screen"/></head><body><h1>yui-overrides.js</h1><pre class="highlighted"><code><i>// add ability <b>for</b> callbacks <b>with</b> animations</i>
<b>if</b>(YAHOO.util.Anim){
    YAHOO.util.Anim.prototype.animateX = <b>function</b>(callback, scope){
        <b>var</b> f = <b>function</b>(){
            <b>this</b>.onComplete.unsubscribe(f);
            <b>if</b>(typeof callback == '<b>function</b>'){
                callback.call(scope || <b>this</b>, <b>this</b>);
            }
        };
        <b>this</b>.onComplete.subscribe(f, <b>this</b>, true);
        <b>this</b>.animate();
    };
}

<i>/*
 * A simple enhancement to drag drop that allows you to constrain the movement of the
 * DD or DDProxy object to a particular element.&lt;br /&gt;&lt;br /&gt;
 *
 * Usage:
 &lt;pre&gt;&lt;code&gt;
 <b>var</b> dd = <b>new</b> YAHOO.util.DDProxy(&quot;dragDiv1&quot;, &quot;proxytest&quot;,
                { dragElId: &quot;existingProxyDiv&quot; });
 dd.startDrag = <b>function</b>(){
     <b>this</b>.constrainTo('parent-id');
 };
 &lt;/code&gt;&lt;/pre&gt;
 * Or you can initalize it using the {@link Ext.Element} object:
 &lt;pre&gt;&lt;code&gt;
 Ext.get('dragDiv1').initDDProxy('proxytest', {dragElId: &quot;existingProxyDiv&quot;}, {
     startDrag : <b>function</b>(){
         <b>this</b>.constrainTo('parent-id');
     }
 });
 &lt;/code&gt;&lt;/pre&gt;
 */</i>
<b>if</b>(YAHOO.util.DragDrop){
    <i>/*
     * Provides <b>default</b> constraint padding to &quot;constrainTo&quot; elements (defaults to {left: 0, right:0, top:0, bottom:0}).
     * @type Object
     */</i>
    YAHOO.util.DragDrop.prototype.defaultPadding = {left:0, right:0, top:0, bottom:0};

    <i>/*
     * Initializes the drag drop object's constraints to restrict movement to a certain element.
     * @param {String/HTMLElement/Element} constrainTo The element to constrain to.
     * @param {Object/Number} pad (optional) Pad provides a way to specify &quot;padding&quot; of the constraints,
     * and can be either a number <b>for</b> symmetrical padding (4 would be equal to {left:4, right:4, top:4, bottom:4}) or
     * an object containing the sides to pad. For example: {right:10, bottom:10}
     * @param {Boolean} inContent (optional) Constrain the draggable <b>in</b> the content box of the element (inside padding and borders)
     */</i>
    YAHOO.util.DragDrop.prototype.constrainTo = <b>function</b>(constrainTo, pad, inContent){
        <b>if</b>(typeof pad == 'number'){
            pad = {left: pad, right:pad, top:pad, bottom:pad};
        }
        pad = pad || <b>this</b>.defaultPadding;
        <b>var</b> b = Ext.get(<b>this</b>.getEl()).getBox();
        <b>var</b> ce = Ext.get(constrainTo);
        <b>var</b> c = ce.dom == document.body ? { x: 0, y: 0,
                width: YAHOO.util.Dom.getViewportWidth(),
                height: YAHOO.util.Dom.getViewportHeight()} : ce.getBox(inContent || false);
        <b>var</b> topSpace = b.y - c.y;
        <b>var</b> leftSpace = b.x - c.x;

        <b>this</b>.resetConstraints();
        <b>this</b>.setXConstraint(leftSpace - (pad.left||0), <i>// left</i>
                c.width - leftSpace - b.width - (pad.right||0) <i>//right</i>
        );
        <b>this</b>.setYConstraint(topSpace - (pad.top||0), <i>//top</i>
                c.height - topSpace - b.height - (pad.bottom||0) <i>//bottom</i>
        );
    };
}

<i>// various Safari fixes, opera fix</i>
<b>if</b>(Ext.isSafari || Ext.isOpera){<i>// modified getXY which has the fix <b>for</b> Safari bug. Changes are preceded <b>with</b> **</i>
    YAHOO.util.Dom.getXY = <b>function</b>(el) {
        <b>var</b> isIE = Ext.isIE,  isSafari = Ext.isSafari, Y = YAHOO.util;

        <b>var</b> f = <b>function</b>(el) {

        <i>// has to be part of document to have pageXY</i>
            <b>if</b> (el.parentNode === null || el.offsetParent === null ||
                    <b>this</b>.getStyle(el, 'display') == 'none') {
                <b>return</b> false;
            }



            <b>var</b> parentNode = null;
            <b>var</b> pos = [];
            <b>var</b> box;

            <b>if</b> (el.getBoundingClientRect) { <i>// IE</i>
                box = el.getBoundingClientRect();
                <b>var</b> doc = document;
                <b>if</b> ( !<b>this</b>.inDocument(el) &amp;&amp; parent.document != document) {<i>// might be <b>in</b> a frame, need to get its scroll</i>
                    doc = parent.document;

                    <b>if</b> ( !<b>this</b>.isAncestor(doc.documentElement, el) ) {
                        <b>return</b> false;
                    }

                }

                <b>var</b> scrollTop = Math.max(doc.documentElement.scrollTop, doc.body.scrollTop);
                <b>var</b> scrollLeft = Math.max(doc.documentElement.scrollLeft, doc.body.scrollLeft);

                <b>return</b> [box.left + scrollLeft, box.top + scrollTop];
            } <b>else</b> { <i>// safari, opera, &amp; gecko</i>
                pos = [el.offsetLeft, el.offsetTop];
                parentNode = el.offsetParent;
                <b>var</b> hasAbsolute = false; <i>// ** flag <b>if</b> a parent is positioned</i>

                <b>if</b> (parentNode != el) {
                    <b>while</b> (parentNode) {
                        pos[0] += parentNode.offsetLeft;
                        pos[1] += parentNode.offsetTop;
                        <i>// ** only check <b>if</b> needed</i>
                        <b>if</b>(isSafari &amp;&amp; !hasAbsolute &amp;&amp; <b>this</b>.getStyle(parentNode, 'position') == 'absolute' ){
                            hasAbsolute = true;
                        }
                        parentNode = parentNode.offsetParent;
                    }
                }
                <i>// ** safari doubles <b>in</b> some cases, use flag from offsetParent's as well</i>
                <b>if</b> (isSafari &amp;&amp; (hasAbsolute || <b>this</b>.getStyle(el, 'position') == 'absolute')) {
                    pos[0] -= document.body.offsetLeft;
                    pos[1] -= document.body.offsetTop;
                }
            }

            <b>if</b> (el.parentNode) { parentNode = el.parentNode; }
            <b>else</b> { parentNode = null; }

            <b>while</b> (parentNode &amp;&amp; parentNode.tagName.toUpperCase() != 'BODY' &amp;&amp; parentNode.tagName.toUpperCase() != 'HTML')
            { <i>// account <b>for</b> any scrolled ancestors</i>
                <i>// ** opera TR has bad scroll values, so filter them jvs</i>
                <b>if</b> (Y.Dom.getStyle(parentNode, 'display') != 'inline' &amp;&amp; parentNode.tagName.toUpperCase() != 'TR') { <i>// work around opera inline scrollLeft/Top bug</i>
                    pos[0] -= parentNode.scrollLeft;
                    pos[1] -= parentNode.scrollTop;
                }

                <b>if</b> (parentNode.parentNode) {
                    parentNode = parentNode.parentNode;
                } <b>else</b> { parentNode = null; }
            }


            <b>return</b> pos;
        };

        <b>return</b> Y.Dom.batch(el, f, Y.Dom, true);
    };


    <i>// workaround <b>for</b> Safari anim duration speed problems</i>
    <b>if</b>(YAHOO.util.AnimMgr){
        YAHOO.util.AnimMgr.fps = 1000;
    }

    <i>// workaround <b>for</b> Safari 1.3 not supporting hasOwnProperty</i>
    <b>if</b>(YAHOO.util.Connect){
        YAHOO.util.Connect.setHeader = <b>function</b>(o){
            <b>for</b>(var prop <b>in</b> this._http_header){
                <i>// <b>if</b>(this._http_header.hasOwnProperty(prop)){</i>
                <b>if</b>(typeof <b>this</b>._http_header[prop] != '<b>function</b>'){
                    o.conn.setRequestHeader(prop, <b>this</b>._http_header[prop]);
                }
            }
            <b>delete</b> this._http_header;
            <b>this</b>._http_header = {};
            <b>this</b>._has_http_headers = false;
        };
    }
}

YAHOO.util.Region.prototype.adjust = <b>function</b>(t, l, b, r){
    <b>this</b>.top += t;
    <b>this</b>.left += l;
    <b>this</b>.right += r;
    <b>this</b>.bottom += b;
    <b>return</b> this;
};
</code></pre><hr><div style="font-size:10px;text-align:center;color:gray;">yui-ext - Copyright &copy; 2006 Jack Slocum.  |
    Yahoo! UI - Copyright &copy; 2006 Yahoo! Inc.<br />All rights reserved.</div>
    </body></html>